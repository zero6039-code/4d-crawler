- name: Start 60-Minute Loop Scraper
        run: |
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          
          for i in {1..60}
          do
            echo "------------------------------------------"
            echo "æ­£åœ¨åŒæ­¥å®æ—¶å¼€å¥– - è½®æ¬¡: $i"
            
            # æŠ“å–é¦–é¡µ
            curl -sL "https://www.damacai.com.my/" \
              -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36" \
              -o temp.html

            # ä½¿ç”¨æ›´å®½å®¹çš„æ­£åˆ™åŒ¹é…æå–æ•°å­—
            # é€»è¾‘ï¼šå¯»æ‰¾åŒ…å« p1-number çš„è¡Œï¼Œå»æ‰æ‰€æœ‰ HTML æ ‡ç­¾åªç•™æ•°å­—
            P1=$(grep "p1-number" temp.html | sed 's/<[^>]*>//g' | xargs || echo "----")
            P2=$(grep "p2-number" temp.html | sed 's/<[^>]*>//g' | xargs || echo "----")
            P3=$(grep "p3-number" temp.html | sed 's/<[^>]*>//g' | xargs || echo "----")
            DRAWNO=$(grep "draw-no" temp.html | head -1 | sed 's/<[^>]*>//g' | xargs || echo "Pending")

            # æ‰“å°åˆ°æ—¥å¿—æ–¹ä¾¿æŸ¥çœ‹
            echo "æå–ç»“æœ -> æœŸå·: $DRAWNO | é¦–å¥–: $P1 | äºŒå¥–: $P2 | ä¸‰å¥–: $P3"

            # å†™å…¥ JSON
            echo "{\"drawNo\":\"$DRAWNO\", \"p1\":\"$P1\", \"p2\":\"$P2\", \"p3\":\"$P3\"}" > data.json

            git add data.json
            if git commit -m "Live Update: $DRAWNO"; then
              git push
              echo "âœ… æ•°æ®æ›´æ–°æˆåŠŸï¼"
            else
              echo "ğŸ˜´ æ— æ–°å˜åŠ¨ã€‚"
            fi
            
            sleep 60
          done
